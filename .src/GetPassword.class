' Gambas class file


Public Sub GotPasswordButton_Click()

  Print passwordbox.text  ' the sudo askpass -A expects this app to print the password to std out
  GetPassword.Close()

End

Public Sub passwordbox_KeyPress()

  'testbox.text = Str$(Asc(Mid(Key.Text, 1)))
  If Asc(Mid(Key.text, 1)) = 13 Then
    GotPasswordButton_Click()
  Endif

End


Public Sub Form_Close()

  Settings["Window/GetPassword/Top"] = Me.Top
  Settings["Window/GetPassword/Left"] = Me.Left
  Settings["Window/GetPassword/Height"] = Me.Height
  Settings["Window/GetPassword/Width"] = Me.Width

End

Public Sub Form_Open()

  Me.Top = Settings["Window/GetPassword/Top", Me.Top]
  Me.Left = Settings["Window/GetPassword/Left", Me.Left]
  Me.Height = Settings["Window/GetPassword/Height", Me.Height]
  Me.Width = Settings["Window/GetPassword/Width", Me.Width]

End
